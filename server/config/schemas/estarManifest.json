{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "eSTAR Plus Manifest Schema",
  "description": "JSON Schema for validating FDA eSTAR Plus submission manifests",
  "type": "object",
  "required": ["estarSubmission"],
  "properties": {
    "estarSubmission": {
      "type": "object",
      "required": [
        "metadata",
        "sections"
      ],
      "properties": {
        "metadata": {
          "type": "object",
          "required": [
            "submissionId",
            "submissionDate",
            "applicant",
            "deviceName",
            "deviceClass"
          ],
          "properties": {
            "submissionId": {
              "type": "string",
              "description": "Unique identifier for the submission",
              "minLength": 1
            },
            "submissionDate": {
              "type": "string",
              "description": "Date of submission in ISO format",
              "format": "date-time"
            },
            "applicant": {
              "type": "object",
              "required": ["name"],
              "properties": {
                "name": {
                  "type": "string",
                  "minLength": 1
                },
                "address": {
                  "type": "string"
                },
                "contactPerson": {
                  "type": "string"
                },
                "phoneNumber": {
                  "type": "string"
                },
                "email": {
                  "type": "string",
                  "format": "email"
                }
              }
            },
            "deviceName": {
              "type": "string",
              "minLength": 1
            },
            "deviceClass": {
              "type": "string",
              "enum": ["I", "II", "III"]
            },
            "productCode": {
              "type": "string"
            },
            "regulationNumber": {
              "type": "string"
            },
            "submissionType": {
              "type": "string",
              "enum": ["Traditional", "Special", "Abbreviated"]
            }
          }
        },
        "sections": {
          "type": "array",
          "minItems": 1,
          "items": {
            "type": "object",
            "required": [
              "sectionId",
              "title",
              "files"
            ],
            "properties": {
              "sectionId": {
                "type": "string",
                "minLength": 1
              },
              "title": {
                "type": "string",
                "minLength": 1
              },
              "description": {
                "type": "string"
              },
              "files": {
                "type": "array",
                "minItems": 1,
                "items": {
                  "type": "object",
                  "required": [
                    "fileName",
                    "path",
                    "fileType"
                  ],
                  "properties": {
                    "fileName": {
                      "type": "string",
                      "minLength": 1
                    },
                    "path": {
                      "type": "string",
                      "minLength": 1
                    },
                    "fileType": {
                      "type": "string",
                      "enum": ["pdf", "docx", "xlsx", "pptx", "xml", "json", "txt", "jpg", "png"]
                    },
                    "fileSize": {
                      "type": "number",
                      "minimum": 0
                    },
                    "contentDescription": {
                      "type": "string"
                    },
                    "hashValue": {
                      "type": "string"
                    },
                    "hashAlgorithm": {
                      "type": "string",
                      "enum": ["SHA-256", "SHA-512", "MD5"]
                    }
                  }
                }
              }
            }
          }
        },
        "digitalSignature": {
          "type": "object",
          "required": [
            "algorithm",
            "value",
            "signedAt"
          ],
          "properties": {
            "algorithm": {
              "type": "string",
              "enum": ["HMAC-SHA256", "RSA-SHA256"]
            },
            "value": {
              "type": "string",
              "minLength": 64
            },
            "signedAt": {
              "type": "string",
              "format": "date-time"
            },
            "certificate": {
              "type": "string"
            }
          }
        }
      }
    }
  }
}