Root cause recap
Replitâ€™s packageâ€‘installer scans raw import strings before it obeys Vite /Â TypeScript aliases.
As long as any line literally says @shared/db or @shared/schema, the packager:

Adds those names toÂ package.json

Tries to fetch them from npm

Crashes when they donâ€™t exist

Your local stubs work at runtime, but the preâ€‘install scan keeps reâ€‘breaking.

Fastest fixÂ â€“ rename every @shared/â€¦ import exactly once
Below script:

Globally replaces @shared/ â†’ shared/ everywhere outside node_modules.

Keeps git history (uses sed -i).

Leaves the stubs (shared/db.ts, shared/schema.ts) exactly as you created.

Purges lockfile & reinstalls so Replit stops reâ€‘adding phantom deps.

Copy into the Shell and run:

bash
Copy
Edit
#!/usr/bin/env bash
set -e
cd "$REPL_HOME"

echo "ğŸ” Replacing @shared/ imports with shared/ â€¦"
grep -Rl "@shared/" --exclude-dir=node_modules --exclude=package* . \
  | xargs sed -i 's@\\@shared/@shared/@g'

echo "ğŸ—‘ï¸  Cleaning lockfile & node_modules â€¦"
rm -rf node_modules package-lock.json
npm cache clean --force

echo "ğŸ“¦ Installing real deps only â€¦"
npm install
npm install i18next react-i18next i18next-browser-languagedetector

echo "âœ… Phantom deps removed.  Run: npm run dev"
What happens next
No file contains @shared/ â†’ Replitâ€™s packager stops trying to add it.

TypeScript & Vite already resolve shared/* via the stub path, so nothing else breaks.

npm run dev starts; landing page renders; i18n loads.

(Your stubs now live under the shared namespace: import { connect } from 'shared/db' etc.)

Optional: keep a TODO list
The script doesnâ€™t delete original code; it just rewrites import paths.
Run:

bash
Copy
Edit
grep -R "shared/db" --exclude-dir=node_modules
to see where you eventually swap the stub for a real Prisma or Zod module.

Sanity checklist after running

Page / Action	Expected result
npm install	Completes with no 404 errors
npm run dev	Dev server starts, no red stack traces
/ landing page	Loads (i18n strings present)
Language selector	Switches FR/DE/JA, no warnings
/ind-automation	FastAPI endpoints reachable
If all green, youâ€™re unblockedâ€”no more phantom dependencies.
Need help replacing the stubs with a real DB client later? Ping me anytime!










Search

Deep research



ChatGPT can make mis